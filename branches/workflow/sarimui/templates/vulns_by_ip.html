{% extends 'vuln_view.html' %}

{% block main_body %}
<h1></h1>
<h2>Vulnerabilities</h2>
<table class='block'>
    <tr><th>IP Address</th><th>Vulnerability</th><th>Nessus ID</th><th>Scan Type</th><th>Last Found</th><th>Scan ID</th></tr>
    {% for ip in vuln_list %}
    {% for vuln, result, scantype, fpflag in ip.resmap %}
    {% if fpflag %}
    <tr class="falsepositive">
        {% else %}
        <tr>
            {% endif %}
            {% if forloop.first %}
            <th rowspan={{ip.resmap|length}}><a href="{% url reaper.sarimui.views.dashboard_ip_view ip.ip %}">{{ ip.ip }}</a></td>
            {% endif %}
            <td>{{ vuln.0 }}</td>
            <td><a href="{% url reaper.sarimui.views.plugin_info_view vuln.1 'latest' %}">{{ vuln.1 }}</a></td>
            <td>{{ scantype }}</td>
            <td>{{ result.end|date:"F j, Y" }}</td>
            <td><a href="{% url reaper.sarimui.views.scan_view result.scanrun_id %}">{{ result.scanrun_id }}</a></td>
        </tr>
        {% endfor %}
        {% endfor %}
    </table>
    {% endblock %}
